<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>First Weather Map</title>
    <!-- Mapbox CSS -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/weather.css">
</head>
<body>
<div class="Header">
    <div class="row">
        <h1>Weather App</h1>
        <div>${Location}</div>
    </div>
</div>
<div id="weatherCardsInfo" class="container"></div>

<div>
    <input type="text" value="San Antonio, TX" id="input1">
    <button class="input1-1">Location Info</button>
</div>
    <div id="map"></div>

    <script src="js/keys.js"></script>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
    <script src="js/weather.js"></script>
<script>
(async function(){
            mapboxgl.accessToken = MAPBOX_API_KEY;
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v9',
            zoom: 10,
            center: [-98.4916, 29.4252],
            bearing: -0
        });
        const marker = new mapboxgl.Marker({
            draggable: true
        })
    marker.setLngLat([-98.4916, 29.4252])
    marker.addTo(map)
    function onDragEnd() {
            const lngLat = marker.getLngLat();
        console.log(lngLat);
        getForcast(lngLat)
    }
    marker.on('dragend', onDragEnd);

function getForcast(lngLat) {
    let queryParams = new URLSearchParams({
        APPID: OPENWEATHER_API_KEY,
        lat:    `${lngLat.lat}`,
        lon:   `${lngLat.lng}`,
        units: "imperial"
    });
    fetch("http://api.openweathermap.org/data/2.5/onecall?" + queryParams, {
            method: "GET"
        }
    ).then(async function (response) {
        let weatherData = await response.json();
        // for (let i = 0; i < weatherData.daily.length; i++) {
            console.log(weatherData.daily);
            weatherCards(weatherData.daily);
        // }
    });

}


        })();
</script>
</body>
</html>
